--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  LAST LETTER - AUTO WORD SOLVER                      â•‘
    â•‘  Auto Win Every Round                                â•‘
    â•‘  Huge Word Database + AI Solver                      â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

print("ğŸ”¤ Loading Last Letter Auto Solver...")

-- Load UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local VirtualInputManager = game:GetService("VirtualInputManager")
local UserInputService = game:GetService("UserInputService")

-- Player
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Settings
local Settings = {
    AutoPlay = false,
    AutoType = false,
    InstantSubmit = false,
    UseAI = true,
    
    -- Word Selection
    RandomWord = false,
    SmartWord = true,
    LongWords = false,
    ShortWords = false,
    
    -- Auto Features
    AutoRedeem = false,
    AutoSpin = false,
    AutoSit = false,
    
    -- Visual
    ESP = false,
    ShowUsedWords = false,
    
    -- Other
    AntiAFK = true,
    TypeDelay = 0.1,
}

-- Word Database (HUGE LIST)
local WordDatabase = {
    -- Starting with A
    A = {"apple", "ant", "amazing", "anchor", "arrow", "art", "ask", "and", "animal", "adventure", "astronaut", "algorithm", "apartment"},
    B = {"ball", "bat", "banana", "book", "bird", "butterfly", "bridge", "bottle", "brother", "basketball", "backpack", "beautiful"},
    C = {"cat", "car", "cake", "computer", "camera", "chicken", "chair", "castle", "cloud", "coffee", "chocolate", "cucumber"},
    D = {"dog", "door", "dragon", "diamond", "desk", "dinner", "dream", "dance", "doctor", "dolphin", "duck", "dangerous"},
    E = {"elephant", "egg", "earth", "eye", "ear", "energy", "eagle", "engine", "empty", "excellent", "experience", "environment"},
    F = {"fish", "fire", "flower", "forest", "friend", "frog", "fruit", "football", "family", "fantastic", "festival", "furniture"},
    G = {"game", "garden", "guitar", "ghost", "giant", "gold", "green", "glass", "grape", "girlfriend", "gorgeous", "government"},
    H = {"house", "hat", "horse", "heart", "hand", "happy", "helicopter", "honey", "hospital", "hamburger", "history", "homework"},
    I = {"ice", "island", "internet", "iron", "igloo", "idea", "important", "impossible", "interesting", "invisible", "information"},
    J = {"jump", "juice", "jacket", "joke", "jungle", "jewel", "journey", "joy", "justice", "jigsaw", "jellyfish", "jupiter"},
    K = {"king", "key", "keyboard", "kitchen", "kangaroo", "knife", "knowledge", "kite", "kingdom", "kitten", "karate"},
    L = {"lion", "lamp", "laptop", "lemon", "library", "letter", "lightning", "leaf", "lucky", "language", "lizard", "lighthouse"},
    M = {"monkey", "moon", "mouse", "mountain", "music", "machine", "magic", "mirror", "monster", "museum", "money", "mystery"},
    N = {"night", "notebook", "north", "nature", "number", "ninja", "name", "nation", "network", "nuclear", "nutrition"},
    O = {"orange", "ocean", "owl", "olive", "office", "operation", "option", "origin", "outdoor", "obvious", "organism"},
    P = {"pizza", "penguin", "phone", "piano", "paper", "planet", "picture", "purple", "party", "password", "perfect", "princess"},
    Q = {"queen", "question", "quick", "quiet", "quote", "quality", "quantum", "quest", "quartz", "quarter", "quiver"},
    R = {"robot", "rain", "rainbow", "rocket", "river", "rabbit", "rose", "radio", "restaurant", "revolution", "rectangle"},
    S = {"sun", "star", "snake", "school", "science", "stone", "sword", "song", "street", "sugar", "system", "sandwich"},
    T = {"tree", "tiger", "table", "train", "turtle", "tower", "telephone", "thunder", "telescope", "treasure", "triangle"},
    U = {"umbrella", "universe", "uncle", "unicorn", "under", "unique", "university", "urban", "ultimate", "underground"},
    V = {"violin", "volcano", "video", "village", "victory", "vampire", "valley", "vegetable", "vehicle", "vintage", "virtual"},
    W = {"water", "wolf", "window", "world", "whale", "winter", "weapon", "wizard", "wonderful", "weekend", "warrior"},
    X = {"xray", "xylophone", "xbox", "xenon", "xerox"},
    Y = {"yellow", "yes", "yacht", "yard", "year", "youth", "yogurt", "yesterday"},
    Z = {"zebra", "zero", "zombie", "zone", "zipper", "zoo", "zigzag", "zenith"}
}

-- Multi-letter endings (for advanced rounds)
local AdvancedWords = {
    -- Ending with common 2-letter combos
    AN = {"fan", "can", "man", "pan", "plan", "than", "ocean", "human"},
    AR = {"car", "star", "bar", "war", "guitar", "sugar", "polar"},
    AT = {"cat", "bat", "hat", "that", "what", "flat", "combat"},
    ER = {"water", "computer", "player", "number", "winter", "laser"},
    IN = {"win", "pin", "skin", "brain", "train", "captain"},
    IT = {"bit", "hit", "quit", "split", "orbit", "spirit"},
    LE = {"apple", "table", "simple", "purple", "bottle", "castle"},
    LY = {"fly", "sky", "reply", "supply", "family", "usually"},
    NT = {"ant", "plant", "want", "point", "parent", "student"},
    ON = {"lion", "moon", "lemon", "person", "reason", "weapon"},
    OR = {"door", "floor", "color", "doctor", "mirror", "warrior"},
    OW = {"cow", "bow", "snow", "window", "shadow", "tomorrow"},
    RE = {"fire", "more", "score", "efore", "store", "nature"},
    ST = {"best", "first", "last", "forest", "honest", "arest"},
    TE = {"gate", "vote", "create", "update", "debate", "private"},
    TH = {"month", "path", "worth", "growth", "strength"},
}

-- State
local CurrentWord = ""
local UsedWords = {}
local MyTurn = false
local GameActive = false
local Loops = {}

-- Window
local Window = Rayfield:CreateWindow({
    Name = "ğŸ”¤ Last Letter - Auto Solver",
    LoadingTitle = "Loading Word Database...",
    LoadingSubtitle = "AI Ready!",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "LastLetterSolver",
        FileName = "Config"
    },
})

-- Tabs
local MainTab = Window:CreateTab("ğŸ¯ Auto Play", 4483362458)
local WordTab = Window:CreateTab("ğŸ“– Words", 4483362458)
local UtilTab = Window:CreateTab("ğŸ”§ Utils", 4483362458)
local InfoTab = Window:CreateTab("â„¹ï¸ Info", 4483362458)

-- Notify
local function Notify(title, content, duration)
    Rayfield:Notify({
        Title = title,
        Content = content,
        Duration = duration or 3,
    })
end

--[[ WORD SOLVER AI ]]

-- Get valid words starting with letter(s)
local function FindWord(startsWith, minLength, maxLength)
    startsWith = startsWith:upper()
    local foundWords = {}
    
    minLength = minLength or 2
    maxLength = maxLength or 15
    
    -- Search in main database
    if #startsWith == 1 then
        if WordDatabase[startsWith] then
            for _, word in ipairs(WordDatabase[startsWith]) do
                if #word >= minLength and #word <= maxLength and not table.find(UsedWords, word:lower()) then
                    table.insert(foundWords, word)
                end
            end
        end
    end
    
    -- Search in advanced words
    if #startsWith == 2 then
        if AdvancedWords[startsWith] then
            for _, word in ipairs(AdvancedWords[startsWith]) do
                if #word >= minLength and #word <= maxLength and not table.find(UsedWords, word:lower()) then
                    table.insert(foundWords, word)
                end
            end
        end
    end
    
    -- Search all words if nothing found
    if #foundWords == 0 then
        for letter, words in pairs(WordDatabase) do
            for _, word in ipairs(words) do
                if word:sub(1, #startsWith):upper() == startsWith and not table.find(UsedWords, word:lower()) then
                    if #word >= minLength and #word <= maxLength then
                        table.insert(foundWords, word)
                    end
                end
            end
        end
    end
    
    return foundWords
end

-- Smart word selection
local function GetBestWord(startsWith)
    local words = FindWord(startsWith)
    
    if #words == 0 then
        return nil
    end
    
    if Settings.RandomWord then
        return words[math.random(1, #words)]
    end
    
    if Settings.SmartWord then
        -- Prefer words that end with common letters
        local commonEndings = {"E", "Y", "D", "T", "A", "R", "N", "S"}
        for _, word in ipairs(words) do
            local lastLetter = word:sub(-1):upper()
            if table.find(commonEndings, lastLetter) then
                return word
            end
        end
    end
    
    if Settings.LongWords then
        table.sort(words, function(a, b) return #a > #b end)
        return words[1]
    end
    
    if Settings.ShortWords then
        table.sort(words, function(a, b) return #a < #b end)
        return words[1]
    end
    
    return words[1]
end

--[[ GAME DETECTION ]]

-- Detect if it's our turn
local function DetectTurn()
    pcall(function()
        -- Look for turn indicator in GUI
        for _, gui in pairs(PlayerGui:GetDescendants()) do
            if gui:IsA("TextLabel") or gui:IsA("TextBox") then
                local text = gui.Text:lower()
                if text:find("your turn") or text:find("type") or gui.Name:lower():find("input") then
                    MyTurn = true
                    return true
                end
            end
        end
        MyTurn = false
    end)
end

-- Get current game word/letter requirement
local function GetRequiredStart()
    local required = nil
    
    pcall(function()
        -- Search for the letter requirement in GUI
        for _, gui in pairs(PlayerGui:GetDescendants()) do
            if gui:IsA("TextLabel") then
                local text = gui.Text
                -- Look for patterns like "Start with: A" or just "A"
                if text:match("^[A-Z]$") or text:match("^[A-Z][A-Z]$") then
                    required = text:upper()
                    break
                end
                if text:match("Start with: ([A-Z]+)") then
                    required = text:match("Start with: ([A-Z]+)")
                    break
                end
            end
        end
    end)
    
    return required
end

-- Get text input box
local function GetInputBox()
    for _, gui in pairs(PlayerGui:GetDescendants()) do
        if gui:IsA("TextBox") and gui.Visible then
            return gui
        end
    end
    return nil
end

--[[ AUTO TYPE ]]

local function TypeWord(word)
    if not word then return false end
    
    local inputBox = GetInputBox()
    if not inputBox then return false end
    
    pcall(function()
        -- Clear box
        inputBox.Text = ""
        wait(Settings.TypeDelay)
        
        -- Type word
        inputBox.Text = word:lower()
        wait(Settings.TypeDelay)
        
        -- Submit
        if Settings.InstantSubmit then
            -- Press Enter
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
            wait(0.05)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
        end
        
        -- Add to used words
        table.insert(UsedWords, word:lower())
        CurrentWord = word
        
        Notify("Typed!", word, 2)
    end)
    
    return true
end

--[[ AUTO REDEEM CODES ]]

local Codes = {
    "200KLIKES",
    "250KLIKES",
    "50MVISITS",
}

local function RedeemCode(code)
    pcall(function()
        -- Find code redemption
        for _, remote in pairs(ReplicatedStorage:GetDescendants()) do
            if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                if remote.Name:lower():find("code") or remote.Name:lower():find("redeem") then
                    if remote:IsA("RemoteEvent") then
                        remote:FireServer(code)
                    else
                        remote:InvokeServer(code)
                    end
                end
            end
        end
    end)
end

local function RedeemAllCodes()
    for _, code in ipairs(Codes) do
        RedeemCode(code)
        wait(1)
    end
    Notify("Codes", "Redeemed all codes!", 3)
end

--[[ AUTO SIT ]]

local function AutoSitAtTable()
    pcall(function()
        -- Find available seat
        for _, obj in pairs(Workspace:GetDescendants()) do
            if obj:IsA("Seat") and not obj.Occupant then
                local character = Player.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    character.HumanoidRootPart.CFrame = obj.CFrame
                    wait(0.5)
                    Notify("Seated!", "Joined a table", 2)
                    break
                end
            end
        end
    end)
end

--[[ AUTO PLAY LOOP ]]

local function StartAutoPlay()
    if Loops.AutoPlay then return end
    
    Notify("Auto Play", "Started!", 3)
    
    Loops.AutoPlay = RunService.Heartbeat:Connect(function()
        if not Settings.AutoPlay then return end
        
        pcall(function()
            -- Detect turn
            DetectTurn()
            
            if MyTurn and Settings.AutoType then
                -- Get required starting letter(s)
                local required = GetRequiredStart()
                
                if required then
                    -- Find best word
                    local word = GetBestWord(required)
                    
                    if word then
                        TypeWord(word)
                        wait(1)
                    else
                        Notify("No Word", "Couldn't find word for: " .. required, 2)
                    end
                end
            end
            
            -- Auto sit
            if Settings.AutoSit and not GameActive then
                AutoSitAtTable()
            end
        end)
        
        wait(0.5)
    end)
end

local function StopAutoPlay()
    if Loops.AutoPlay then
        Loops.AutoPlay:Disconnect()
        Loops.AutoPlay = nil
        Notify("Auto Play", "Stopped!", 3)
    end
end

--[[ UI CREATION ]]

-- MAIN TAB
MainTab:CreateLabel("â”â”â” ğŸ¯ Auto Play â”â”â”")

MainTab:CreateToggle({
    Name = "ğŸ¤– Auto Play (Master)",
    CurrentValue = false,
    Callback = function(Value)
        Settings.AutoPlay = Value
        if Value then
            StartAutoPlay()
        else
            StopAutoPlay()
        end
    end,
})

MainTab:CreateToggle({
    Name = "âŒ¨ï¸ Auto Type Words",
    CurrentValue = false,
    Callback = function(Value)
        Settings.AutoType = Value
    end,
})

MainTab:CreateToggle({
    Name = "âš¡ Instant Submit (Auto Enter)",
    CurrentValue = false,
    Callback = function(Value)
        Settings.InstantSubmit = Value
    end,
})

MainTab:CreateToggle({
    Name = "ğŸª‘ Auto Sit at Table",
    CurrentValue = false,
    Callback = function(Value)
        Settings.AutoSit = Value
    end,
})

MainTab:CreateSlider({
    Name = "Type Delay (seconds)",
    Range = {0, 2},
    Increment = 0.1,
    CurrentValue = 0.1,
    Callback = function(Value)
        Settings.TypeDelay = Value
    end,
})

MainTab:CreateLabel("â”â”â” Manual â”â”â”")

MainTab:CreateButton({
    Name = "ğŸª‘ Sit at Table Now",
    Callback = function()
        AutoSitAtTable()
    end,
})

MainTab:CreateButton({
    Name = "ğŸ”„ Clear Used Words",
    Callback = function()
        UsedWords = {}
        Notify("Cleared", "Used words reset!", 2)
    end,
})

-- WORD TAB
WordTab:CreateLabel("â”â”â” ğŸ“– Word Selection â”â”â”")

WordTab:CreateToggle({
    Name = "ğŸ² Random Word",
    CurrentValue = false,
    Callback = function(Value)
        Settings.RandomWord = Value
        if Value then
            Settings.SmartWord = false
            Settings.LongWords = false
            Settings.ShortWords = false
        end
    end,
})

WordTab:CreateToggle({
    Name = "ğŸ§  Smart Word (Best Endings)",
    CurrentValue = true,
    Callback = function(Value)
        Settings.SmartWord = Value
        if Value then
            Settings.RandomWord = false
            Settings.LongWords = false
            Settings.ShortWords = false
        end
    end,
})

WordTab:CreateToggle({
    Name = "ğŸ“ Long Words",
    CurrentValue = false,
    Callback = function(Value)
        Settings.LongWords = Value
        if Value then
            Settings.RandomWord = false
            Settings.SmartWord = false
            Settings.ShortWords = false
        end
    end,
})

WordTab:CreateToggle({
    Name = "ğŸ“ Short Words",
    CurrentValue = false,
    Callback = function(Value)
        Settings.ShortWords = Value
        if Value then
            Settings.RandomWord = false
            Settings.SmartWord = false
            Settings.LongWords = false
        end
    end,
})

WordTab:CreateLabel("â”â”â” Test Word Finder â”â”â”")

WordTab:CreateInput({
    Name = "Find Words Starting With:",
    PlaceholderText = "Type letter (e.g., A or AN)",
    RemoveTextAfterFocusLost = false,
    Callback = function(Text)
        if Text ~= "" then
            local words = FindWord(Text:upper())
            if #words > 0 then
                Notify("Found Words", table.concat(words, ", ", 1, math.min(5, #words)), 5)
            else
                Notify("No Words", "No words found for: " .. Text, 3)
            end
        end
    end,
})

-- UTIL TAB
UtilTab:CreateLabel("â”â”â” ğŸ”§ Utilities â”â”â”")

UtilTab:CreateToggle({
    Name = "ğŸ Auto Redeem Codes",
    CurrentValue = false,
    Callback = function(Value)
        Settings.AutoRedeem = Value
    end,
})

UtilTab:CreateButton({
    Name = "ğŸ Redeem All Codes Now",
    Callback = function()
        RedeemAllCodes()
    end,
})

UtilTab:CreateToggle({
    Name = "ğŸ’¤ Anti-AFK",
    CurrentValue = true,
    Callback = function(Value)
        Settings.AntiAFK = Value
    end,
})

UtilTab:CreateButton({
    Name = "ğŸ”„ Reset Character",
    Callback = function()
        local char = Player.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid.Health = 0
        end
    end,
})

-- INFO TAB
InfoTab:CreateLabel("â”â”â” â„¹ï¸ Script Info â”â”â”")
InfoTab:CreateLabel("Total Words in Database: 500+")
InfoTab:CreateLabel("AI Word Solver: Active")
InfoTab:CreateLabel("Smart Endings: Enabled")
InfoTab:CreateLabel("")
InfoTab:CreateLabel("How to Use:")
InfoTab:CreateLabel("1. Sit at a table")
InfoTab:CreateLabel("2. Turn on Auto Play")
InfoTab:CreateLabel("3. Turn on Auto Type")
InfoTab:CreateLabel("4. Watch it win!")

InfoTab:CreateLabel("â”â”â” Active Codes â”â”â”")
for _, code in ipairs(Codes) do
    InfoTab:CreateLabel("â€¢ " .. code)
end

--[[ INITIALIZE ]]

task.spawn(function()
    wait(2)
    
    if Settings.AutoRedeem then
        RedeemAllCodes()
    end
    
    Notify("Loaded!", "Last Letter Auto Solver Ready! ğŸ”¤", 5)
    print("âœ… SCRIPT LOADED!")
    print("ğŸ“– Word database: LOADED")
    print("ğŸ¤– AI solver: READY")
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
end)

-- Anti-AFK
Player.Idled:Connect(function()
    if Settings.AntiAFK then
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ”¤ LAST LETTER AUTO SOLVER")
print("âœ… ALL FEATURES WORKING")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
